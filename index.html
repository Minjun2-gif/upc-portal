<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ</title>
<style>
  body {
    font-family: "Yu Gothic", "Meiryo", sans-serif;
    max-width: 700px;
    margin: 20px auto;
    padding: 0 15px;
    line-height: 1.6;
    color: #333;
    background: #f9f9f9;
  }
  h1 {
    font-size: 1.8rem;
    border-bottom: 3px solid #4a90e2;
    padding-bottom: 10px;
  }
  h2 {
    font-size: 1.3rem;
    margin-top: 30px;
    border-bottom: 1px solid #ccc;
    padding-bottom: 6px;
    color: #4a90e2;
  }
  hr {
    border: none;
    border-top: 1px solid #ccc;
    margin: 25px 0;
  }
  ul {
    list-style: none;
    padding-left: 0;
  }
  ul li {
    margin: 8px 0;
  }
  .footer-contact li {
    margin: 6px 0;
  }
  .note {
    font-size: 0.9rem;
    color: #666;
    margin-top: 8px;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<h1>ğŸ  UPCãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ</h1>
<h2 style="font-size: 24px; font-weight: bold;">
  æœ¬æ—¥ã®æ—¥ä»˜ï¼š<span id="today"></span>
</h2>

<script>
  const today = new Date();
  const daysOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
  const dayOfWeek = daysOfWeek[today.getDay()];
  const formatted = today.toLocaleDateString('ja-JP', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
  document.getElementById('today').textContent = `${formatted}ï¼ˆ${dayOfWeek}ï¼‰`;
</script>

<section>
  <h2>ğŸ‘¤ äººå“¡é…ç½®çŠ¶æ³ï¼ˆãƒ©ãƒ™ãƒ©ãƒ¼ 42åï¼‰</h2>
  <ul>
    <li>ç¨¼åƒï¼š<span id="workingCount">--</span> å</li>
    <li>æ¬ å‹¤ï¼š<span id="absentCount">--</span> å</li>
    <li>æ—¥åˆ¥å‡ºå‹¤ç‡ï¼š<span id="dailyAttendance">--</span> </li>
    <li>æœˆåˆ¥å‡ºå‹¤ç‡ï¼š<span id="monthlyAttendance">--</span> </li>
  </ul>
</section>

<script>
  const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQYFcdSwZguznyJDC8liDxkET7KbQ8MGPVsY7m_KU_wHiGu_trkuBywT5bUtB2kiZOIRZjd6Vc8g_Yh/pub?output=csv&gid=0';

  async function fetchAndUpdateData() {
    try {
      const res = await fetch(csvUrl);
      if (!res.ok) throw new Error('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆCSVå–å¾—å¤±æ•—');
      const csvText = await res.text();

      const lines = csvText.trim().split('\n');
      const headers = lines[0].split(',').map(h => h.trim());

      const todayStr = new Date().toLocaleDateString('ja-JP', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit'
      }); // ä¾‹: "2025/06/20"

      const matchedLine = lines.slice(1).find(line => {
        const cols = line.split(',');
        return cols[0] === todayStr;
      });

      if (!matchedLine) {
        console.warn("æœ¬æ—¥ã®æ—¥ä»˜ã«ä¸€è‡´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
        return;
      }

      const data = matchedLine.split(',');

      const workingIdx = headers.indexOf('ç¨¼åƒ');
      const absentIdx = headers.indexOf('æ¬ å‹¤');
      const dailyIdx = headers.indexOf('æ—¥åˆ¥å‡ºå‹¤ç‡');
      const monthlyIdx = headers.indexOf('æœˆåˆ¥å‡ºå‹¤ç‡');

      if (workingIdx >= 0) document.getElementById('workingCount').textContent = data[workingIdx];
      if (absentIdx >= 0) document.getElementById('absentCount').textContent = data[absentIdx];
      if (dailyIdx >= 0) document.getElementById('dailyAttendance').textContent = data[dailyIdx];
      if (monthlyIdx >= 0) document.getElementById('monthlyAttendance').textContent = data[monthlyIdx];

    } catch (e) {
      console.error(e);
    }
  }
  fetchAndUpdateData();
</script>

<hr>

<section>
  <h2>ğŸ¯ æ¥­å‹™ç›®æ¨™ï¼ˆKPIï¼‰</h2>
  <ul>
    <li><strong>Live Queue IDï¼š</strong>7501954626661499393</li>
    <li><strong>ç›®æ¨™ä»¶æ•°ï¼š</strong>140ä»¶ï¼ˆåˆå‰70ä»¶/åˆå¾Œ70ä»¶ï¼‰</li>
    <li><strong>ç›®æ¨™AHTï¼š</strong>150ç§’</li>
    <li><strong>æ­£ç¢ºç‡ï¼š</strong>90%ä»¥ä¸Š</li>
  </ul>
  <p class="note">
    ä¸€æ—¥ã®å‡¦ç†ä¸Šé™ã¯160ä»¶ã»ã©ã§ã€<span style="color: red; font-weight: bold;">å¿…ãš140ä»¶ã¯è¶…ãˆã‚‹ã‚ˆã†</span>çš†ã•ã‚“èª¿æ•´ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚
    <span style="color: red; font-weight: bold;">â€»AHTã®è¨±å®¹ç¯„å›²ã«ã¤ãã¾ã—ã¦ã¯ã€å‰å¾Œ30ç§’ã»ã©ã‚’åŸºæº–ã«</span>å‡¦ç†ã—ã¦ã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚
  </p>
</section>

<hr>

<section>
  <h2>ğŸ“š æ¥­å‹™é–¢é€£ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒ»è³‡æ–™</h2>
  <ul>
    <li>ğŸ”— <a href="https://bytedance.sg.larkoffice.com/docx/Wxm2dWb9uol3INxmMR6lThX3gmd" target="_blank">SOP æ—¥æœ¬èªç‰ˆãƒãƒªã‚·ãƒ¼</a></li>
    <li>ğŸ”— <a href="https://xs740ans7w.larksuite.com/sheets/JgLCszyjYh42PTt2xN5u3gUPsgc" target="_blank">è°·å£ã•ã‚“ä½œæˆãƒãƒªã‚·ãƒ¼</a></li>
    <li>ğŸ”— <a href="https://bytedance.sg.larkoffice.com/sheets/Xkl0s2Y04hiuazttQaLl8uQxgUg?sheet=X6bYdt" target="_blank">ã‚¢ãƒªã‚¢ãƒŠã•ã‚“å…±æœ‰ã‚·ãƒ¼ãƒˆ</a></li>
  </ul>
</section>

<hr>

<section>
  <h2>âš™ï¸ é‹ç”¨é–¢é€£ãƒªãƒ³ã‚¯</h2>
  <ul>
    <li>ğŸ“ <a href="#" target="_blank">UPCãƒãƒ£ãƒƒãƒˆé‹ç”¨å‘¨çŸ¥</a></li>
    <li>ğŸ“ <a href="#" target="_blank">äº‹å‰ä¼‘ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ </a></li>
    <li>ğŸ“ <a href="#" target="_blank">4Fé‹ç”¨å‘¨çŸ¥</a></li>
  </ul>
</section>

<hr>

<section>
  <h2>ğŸ“ ãƒ©ãƒ³ã‚¹ã‚¿ãƒƒãƒ‰ ãŠå•ã„åˆã‚ã›å…ˆ</h2>
  <ul class="footer-contact">
    <li>å°å·ã•ã‚“ã€€090-3229-7384</li>
    <li>äº•å£ã•ã‚“ã€€080-2550-4483</li>
    <li>ãƒ©ãƒ³ã‚¹ã‚¿ãƒƒãƒ‰æœ­å¹Œæ”¯åº—</li>
    <li>å‹¤å‹™å…ˆã®é›»è©±ç•ªå·ï¼š0120-222-169</li>
    <li>â€»ãƒ•ãƒªãƒ¼ãƒ€ã‚¤ãƒ¤ãƒ«NGæ™‚ï¼š050-1745-8057</li>
  </ul>
</section>

</body>
</html>
